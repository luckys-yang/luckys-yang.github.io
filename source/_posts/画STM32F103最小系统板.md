---
title: 画STM32F103最小系统板
cover: /img/num127.webp
categories:
  - EDA
comments: false
katex: true
abbrlink: 87b29bbc
date: 2023-05-04 15:19:22
---



## 前言

{% note blue 'fas fa-fan' flat %}参考{% endnote %}



## 介绍

单片机最小系统一般有 `晶振电路、电源电路、复位电路以及调试电路` 组成

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504162341.webp)

1. 是复位按键
2. 时钟电路部分
3. 芯片
4. BOOT模式选择
5. 电源部分
6. USB转TTL部分
7. 丝印部分
8. 引出的引脚

## 开始

### 主控芯片

1. 打开立创EDA，选择专业版，新建工程，名字自定义，默认是没有图纸的，可以去属性那选择一个图纸，这里我选择的是 `A3`

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504163133.webp)

2. 去器件那搜索 `STM32F103`，封装选择 `48`，选择 `ST`然后筛选，选择编号 `C8304`的器件放置即可然后可以下载数据手册，首先看BOOT的模式

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504163938.webp)

| 启动方式                       | BOOT0 | BOOT1 |
| ------------------------------ | ----- | ----- |
| 从主闪存存储器启动             | 0     | x     |
| 从系统存储器启动               | 1     | 0     |
| 从内置SRAM启动(掉电程序就没了) | 1     | 1     |

一般来说只用到前面两种方式，所以在BOOT0那放一个按键，然后把BOOT1下拉，效果如下：

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504171745.webp)

3. 看电源部分，一般取 `3.3V`，要在范围内

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504172042.webp)

可以看到电容选择是 `5个100nF，一个4.7nF`，然后接地，每个ic都要电源入口都要一个电容，一方面可以减少电源噪声对ic的影响，另一方面不让ic的电流变化污染电源，`每个电容对应芯片的每个vcc口`，摆放时要靠近端口，因为铜箔是有电阻的，越靠近电源端口电容才能及时的给芯片供电。

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504172208.webp)

效果如下：

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504173203.webp)

4. 然后可以拉个框把他们包起来放到合适的位置，最终效果如下：

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504173937.webp)



### 复位电路

1. 芯片的复位引脚是 `NRST`，然后看数据手册可以看到它要求 `默认上拉`

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504175810.webp)

2. 这个电路中需要加一个滤波电容，是为了保证复位信号的稳定性和可靠性，由于复位按钮通常都是机械式按钮，按下去之后可能会出现抖动等问题。如果没有电容的存在，当复位按钮发生抖动时，可能会导致复位信号出现一些不稳定的时刻，从而影响系统的正常运行,效果如下：

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504182258.webp)

### 时钟电路

1. 查看手册，可以看到外部高速晶振的取值是最小是1，最大是25，经典是8MHz

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504183846.webp)

外部低速晶振也有，为什么是32.768呢，通过计算器计算，32768一直除以2可以最终得到1Hz的频率，可以定时1s当做RTC的时钟频率

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504184108.webp)

5 pF 至 25 pF 范围（典型值），它是CL1和CL2的串联组合，必须包括 PCB 和 MCU 引脚电容（10 pF可用作对组合引脚和电路板电容的粗略估计）

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504184956.webp)

可以利用公式进行计算，公式是：$CL=\frac{CL1 \times CL2}{CL1+CL2}+Cstray$

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504185333.webp)

> 下面的晶振是无源的

这里的20pF相当于公式里的 `CL`，`Cstray` 的话取一个大概的值就行(手册里说大概是10pF)，代入公式计算即可得出两个电容的取值大概是多少，`CL1和CL2取20pF代入计算是刚刚好的`

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504191114.webp)

2.  `OSC_IN` 和 `OSC_OUT` 引脚是与外部晶振相连接的引脚，在使用外部晶振时，`OSC_IN` 和 `OSC_OUT` 引脚需要将晶振的两个引脚相连接。而当不使用外部晶振而使用内部 RC 振荡器或者其他类型的内置时钟源时，这两个引脚的连接方法会有所不同。

- 对于 100 脚或 144 脚的产品，`OSC_IN` 应接地，`OSC_OUT` 应悬空
- 对于少于 100 脚的产品 `OSC_IN` 和 `OSC_OUT` 分别通过 10k 欧姆电阻连接到 VDD

`OSC32_IN` 和 `OSC32_OUT` 引脚是STM32系列单片机中用于连接外部低速（低于2MHz）晶振或陶瓷谐振器的引脚。这两个引脚的功能与`OSC_IN`和`OSC_OUT`类似，但一般用于低速时钟源的连接。

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504193939.webp)

3. 然后把芯片的4个引脚都引出来，IN和OUT没区别的

> - 画板时晶振尽量离芯片近一点
> - 晶振底部尽量不要穿过其他支路，防止信号串扰

效果图如下：

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504195353.webp)

### 电源电路

因为STM单片机大部分不支持5V，一般是 3.3V，所以需要降压，这就用到 `LDO`稳压，这里选择型号为 `ME6206A33XG`，一般这种器件都有外围电路的，所以需要去看数据手册

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504201200.webp)

看手册可以知道：要接1uF电容，然后VIN接5V，VOUT接3.3V

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504201553.webp)

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504202527.webp)

vdda 和 vssa 必须连接到 vdd 和 vss

> VDD是3.3V，VSS是GND，不要调转否则板子会烧

效果图如下：

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504205957.webp)

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504210018.webp)



### 串口转USB

选择型号为 `CH340N`

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504211039.webp)

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504210705.webp)

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230504210814.webp)

2. RX和TX接串口1的引脚

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230505102445.webp)

3. 选择 Type-C的话需要注意要选择 `16脚` 的才能下载，选择 `6` 脚的只能充电

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230505103304.webp)

4. 看引脚图可以知道它可以正插和反插都不会有影响,`PA6和PA7` 还有 `PB6和PB7` 不要接反，然后 `CC1和CC2` 通常接下拉电阻

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230505103908.webp)

5. 效果如下，CH340N那里的 `V3` 可以不用接5V：

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230505120919.webp)

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230505120940.webp)

6. 然后还有一个排针，要选择 `2.53mm` 的 `20P`

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230505124743.webp)

### 布线

然后点击 `更新/转换原理图到PCB`，会弹出一个框点击确认即可

> 注意的是滤波电容和外部晶振的话要靠近芯片，其他的话任意按自己喜欢摆放即可

可以先点击 `板框`画一个大点的板子然后把这些摆上去摆好再修改板框大小即可

![](https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230505130100.png)
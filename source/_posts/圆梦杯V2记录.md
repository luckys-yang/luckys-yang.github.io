---
title: 圆梦杯V2记录
cover: /img/num149.webp
categories:
  - 比赛
comments: false
abbrlink: ac6a7e5d
date: 2023-09-06 09:28:59
---



{% note blue 'fas fa-fan' flat %}参考文章{% endnote %}

[LED 灯带效果发生器](https://adrianotiger.github.io/Neopixel-Effect-Generator/)

[PWM+DMA驱动灯带](https://controllerstech.com/interface-ws2812-with-stm32/)



> 注：因为原理图跟V1还是差不多的，所以此处就不详细记录基本的东西了，只记一下F1跟F4之间的移植遇到的问题等等，工程文件会上传到Github

## 框图

<img src="https://image-1309791158.cos.ap-guangzhou.myqcloud.com/其他/QQ截图20230905140323.webp" style="zoom:50%;" />



## 资源分配

- 引脚分配

|  引脚   |   引脚功能    |      用作       |
| :-----: | :-----------: | :-------------: |
| **A7**  | **TIM3_CH2**  |    **E_R_B**    |
| **A6**  | **TIM3_CH1**  |    **E_R_A**    |
|   A5    |   TIM2_CH1    |      E_L_A      |
|   B3    |   TIM2_CH2    |      E_L_B      |
| **A4**  | **ADC1_IN4**  |  **Power_ADC**  |
| **B1**  | **ADC1_IN9**  |  **Fire_ADC**   |
| **B0**  | **ADC1_IN8**  |   **MQ2_ADC**   |
|   E2    |   上拉输入    |       L3        |
|   E3    |   上拉输入    |       L2        |
|   E4    |   上拉输入    |       L1        |
|   E5    |   上拉输入    |        M        |
|   E6    |   上拉输入    |       R1        |
|   C13   |   上拉输入    |       R2        |
|   C14   |   上拉输入    |       R3        |
| **C15** | **推挽输出**  |   **Buzzer**    |
|   D0    |   推挽输出    |     L_AIN1      |
|   D1    |   推挽输出    |     L_AIN2      |
| **A1**  | **TIM5_CH2**  |   **L_PWMA**    |
| **A2**  | **TIM5_CH3**  |   **R_PWMB**    |
|   D2    |   推挽输出    |     R_BIN1      |
|   D3    |   推挽输出    |     R_BIN2      |
| **D4**  | **开漏输出**  | **MPU6050_SCL** |
| **D7**  | **开漏输出**  | **MPU6050_SDA** |
|   C5    |   开漏输出    |   ESP01S_RST    |
|   D5    |   USART2_TX   |   BT_ESP01_TX   |
|   D6    |   USART2_RX   |   BT_ESP01_RX   |
| **C6**  | **USART6_TX** |   **ASR_TX**    |
| **C7**  | **USART6_RX** |   **ASR_RX**    |
|   B10   |   USART3_TX   |    openMV_TX    |
|   B11   |   USART3_RX   |    openMV_RX    |
| **B8**  | **开漏输出**  |  **SHT30_SCL**  |
| **B9**  | **开漏输出**  |  **SHT30_SDA**  |
|   B12   |   开漏输出    |    VL53_SCL     |
|   B13   |   开漏输出    |    VL53_SDA     |
| **E0**  | **上拉输入**  |     **K1**      |
| **E1**  | **上拉输入**  |     **K2**      |
|   D12   |   TIM4_CH1    |     WS2812B     |
| **B15** | **推挽输出**  |    **LED_1**    |
| **B14** | **推挽输出**  |    **LED_2**    |
|   A3    |   TIM5_CH4    |     C_Motor     |
| **A0**  | **推挽输出**  |   **LED_sys**   |
|   A9    |   USART1_TX   |     HMI_TX      |
|   A10   |   USART1_RX   |     HMI_RX      |
| **C0**  | **开漏输出**  | **EEPROM_SCL**  |
| **C1**  | **开漏输出**  | **EEPROM_SDA**  |
|   B6    |   推挽输出    |    OLED_SCL     |
|   B7    |   推挽输出    |    OLED_SDA     |

- 其他分配

| 名称  |           用途            |
| :---: | :-----------------------: |
| TIM9  |  串口2WiFI接收中断计数用  |
| TIM8  | 中断里MPU6050，编码器读取 |
| TIM12 | 裸机任务调度，按键检测等  |

